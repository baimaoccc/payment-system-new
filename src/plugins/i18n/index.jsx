import React, { createContext, useContext, useMemo, useEffect } from "react";
import { useSelector, useDispatch } from "react-redux";
import { setLang } from "../../store/slices/ui.js";
import { db } from "../../utils/indexedDB.js";

/**
 * i18n 插件：提供 t 翻译函数与语言切换
 */
const messages = {
	zh: {
		appTitle: "Ceo Pay",
		dashboard: "概览",
		login: "登录",
		logout: "退出登录",
		guest: "访客",
		username: "用户名",
		password: "密码",
		rememberMe: "记住登录",
		rememberDevice: "记住此设备",
		submit: "提交",
		orders: "订单管理",
		users: "用户管理",
		filters: "筛选",
		orderCurrency: "订单币种",
		orderUser: "下单用户",
		successOrder: "成功订单",
		failedOrder: "失败订单",
		status: "状态",
		all: "全部",
		paid: "已支付",
		failed: "失败",
		amount: "金额",
		createdAt: "创建时间",
		merchant: "商户",
		advertiser: "投手",
		customerService: "客服",
		orderId: "订单号",
		role_super_admin: "超级管理员",
		role_admin: "管理员",
		role_merchant: "商户",
		role_cs: "客服",
		role_adv: "投手",
		role_customer: "客户",
		role: "角色",
		language: "语言",
		welcomeTitle: "欢迎使用支付系统",
		welcomeSub: "欢迎使用支付系统",
		createAccount: "创建账号",
		forgotPassword: "忘记密码？",
		signIn: "登录",
		orSignIn: "或使用以下账户登录",
		socialButton: "按钮",
		facebook: "Facebook",
		twitter: "Twitter",
		todayIncome: "今日收入",
		monthlySales: "本月销售",
		salesComparison: "销售对比",
		totalSalesShare: "总销售占比",
		productsPerformance: "产品表现",
		assigned: "指派",
		name: "名称",
		priority: "优先级",
		budget: "预算",
		low: "低",
		medium: "中",
		high: "高",
		ordersCount: "订单数",
		paidCount: "已支付",
		refundsCount: "退款",
		download: "下载",
		apps: "应用",
		chat: "聊天",
		calendar: "日历",
		search: "搜索",
		notifications: "通知",
		messages: "消息",
		theme: "主题",
		light: "浅色",
		dark: "深色",
		earnings: "收入",
		customers: "客户",
		products: "产品",
		sales: "销售",
		recentTransactions: "近期交易",
		downloadReport: "下载报表",
		expense: "支出",
		yearlySales: "年度销售",
		active: "活跃",
		inactive: "未激活",
		good: "良好",
		excellent: "优秀",
		average: "一般",
		bad: "较差",
		addNew: "新增",
		privacyPolicy: "隐私政策",
		termsOfService: "服务条款",
		contactUs: "联系我们",
		userDetailsTitle: "用户信息",
		userDetailsHint: "在此编辑并保存用户信息",
		icpRecord: "备案号",
		totalSales: "总销售额",
		todayOrders: "今日订单",
		todaySales: "今日销售额",
		yesterdayOrders: "昨日订单",
		yesterdaySales: "昨日销售额",
		orderRatio: "今日订单比例",
		cookieSettings: "Cookie 设置",
		userManagement: "用户管理",
		userList: "用户列表",
		addUser: "新增用户",
		editUser: "编辑用户",
		roleManagement: "角色管理",
		addRole: "新增角色",
		editRole: "编辑角色",
		roleName: "角色名称",
		createTime: "创建时间",
		status_active: "激活",
		status_inactive: "未激活",
		actions: "操作",
		noData: "暂无数据",
		clickToUpload: "点击上传图片",
		notShipped: "未发货",
		shipped: "已发货",
		delete: "删除",
		deleteUserSuccess: "删除成功",
		deleteUserFailed: "删除失败",
		createUserSuccess: "新增成功",
		createUserFailed: "新增失败",
		editUserSuccess: "编辑成功",
		editUserFailed: "编辑失败",
		email: "邮箱",
		mobile: "手机号",
		tgid: "TG ID",
		qunid: "群ID",
		total: "总数",
		prev: "上一页",
		next: "下一页",
		save: "保存",
		cancel: "取消",
		captcha: "验证码",
		getCaptcha: "获取验证码",
		pleaseEnterUsername: "请输入用户名",
		captchaFetchFailed: "验证码获取失败",
		captchaFetched: "验证码已获取",
		loginFailed: "登录失败",
		logoutSuccess: "已退出登录",
		logoutFailed: "退出登录失败",
		illustrationPlaceholder: "插画占位",
		missingCaptcha: "缺少验证码",
		// New additions
		clickToEdit: "点击编辑",
		remark: "备注",
		loading: "加载中...",
		orderDetailsAndChannel: "订单详情与渠道",
		customer: "客户",
		timeline: "时间线",
		site: "站点",
		channel_abbr: "渠道",
		untitledOrder: "未命名订单",
		untitledChannel: "未命名渠道",
		ref: "参考号",
		rate: "汇率",
		err: "错误",
		upd: "更新",
		crt: "创建",
		succeed: "成功",
		noPay: "未支付",
		itemsPerPage: "每页条数",
		paginationInfo: "{start} – {end} 共 {total}",
		prevPage: "上一页",
		nextPage: "下一页",
		confirmDelete: "确认删除吗？",
		deleteSuccess: "删除成功",
		deleteFailed: "删除失败",
		saveSuccess: "保存成功",
		saveFailed: "保存失败",
		usernameRequired: "用户名不能为空",
		passwordRequired: "密码不能为空",
		searchPlaceholder: "搜索网站/邮箱/备注",
		pending: "待处理",
		sold: "已售",
		copied: "已复制",
		copyFailed: "复制失败",
		clickToCopy: "点击复制",
		riskScore: "风险评分",
		failureCode: "失败代码",
		failureMsg: "失败信息",
		operations: "操作",
		details: "详情",
		radar: "雷达",
		update: "更新",
		riskAnalysis: "风险分析",
		normalRisk: "普通风险",
		riskScoreExplanation: "该支付的风险因素已与网络中的其他支付进行了对比。",
		customerDetails: "客户详情",
		checkoutDetails: "结账详情",
		customerEmail: "客户邮箱",
		billingAddress: "账单地址",
		ipAddress: "IP地址",
		ipAddressDetail: "IP详情",
		longitudeAndLatitude: "经纬度",
		internetServiceProvider: "互联网服务提供商",
		vpn: "VPN",
		proxy: "代理",
		userAgent: "用户代理",
		paymentDetails: "支付详情",
		cardBrand: "卡品牌",
		fundingType: "资金类型",
		cardCountry: "发卡国家",
		cvcCheck: "CVC 验证",
		threeDSecure: "3D 安全验证",
		wallet: "钱包",
		hostname: "主机名",
		region: "地区",
		postalCode: "邮政编码",
		location: "位置",
		organization: "组织机构",
		timezone: "时区",
		amountAuthorized: "授权金额",
		authCode: "授权代码",
		addressCheck: "地址验证",
		zipCheck: "邮编验证",
		fingerprint: "指纹",
		network: "卡网络",
		networkTransactionId: "网络交易ID",
		orderDetails: "订单详情",
		contactDetails: "联系人详情",
		transactionDetails: "交易详情",
		technicalDetails: "技术详情",
		country: "国家",
		city: "城市",
		zipcode: "邮编",
		idLabel: "ID",
		codeLabel: "代码",
		technicalSub: "IP、用户代理与设备",
		ipv6: "IPv6",
		chargesList: "扣款记录",
		chargesListSub: "该订单关联的所有支付尝试与退款记录",
		paymentMethod: "支付方式",
		date: "日期",
		refunded: "已退款",
		stripeAccounts: "Stripe 账号",
		stripeManagement: "Stripe 管理",
		accountList: "账号列表",
		stripeWhitelistGroups: "白名单分组配置",
		stripeLogs: "Stripe 日志",
		st_id: "ID",
		st_status: "状态",
		st_status_inactive: "暂停",
		st_status_active: "激活",
		st_status_completed: "完成",
		st_status_suspended: "挂起",
		st_group: "分组",
		st_comment: "备注",
		st_site: "站点",
		st_keys: "密钥",
		st_limits: "限额",
		st_stats: "统计",
		st_dates: "时间",
		st_max_money: "最大金额",
		st_max_order: "最大单量",
		st_money_sum: "总金额",
		st_order_count: "总单量",
		st_add: "新增 ST 账号",
		st_edit: "编辑 ST 账号",
		st_pk: "公钥 (PK)",
		st_sk: "私钥 (SK)",
		st_endpoint_secret: "终端密钥 (WhSec)",
		st_desc: "描述",
		st_max_purchase: "单笔限额",
		st_whitelist: "国家白名单",
		st_whitelist_placeholder: "输入国家代码，用逗号分隔 (例如: US, JP)",
		st_whitelist_group: "国家分组",
		st_whitelist_group_placeholder: "选择国家分组",
		st_c_site_url: "C端网址",
		view: "查看",
		logDetails: "日志详情",
		account: "账号",
		type: "类型",
		content: "内容",
		close: "关闭",
		whitelistGroupsTitle: "白名单分组",
		whitelistGroupsSub: "配置 Stripe 账号的国家白名单分组",
		createGroup: "创建分组",
		noGroupsConfigured: "暂无分组配置",
		whitelistGroupFeatureDesc: "此功能允许您创建可复用的国家白名单分组。",
		loadFailed: "加载失败",
		searchGroupPlaceholder: "搜索分组名称",
		featureUnderDevelopment: "功能开发中...",
		enterGroupName: "请输入分组名称",
		selectCountries: "选择国家",
		searchCountries: "搜索国家...",
		pleaseEnterName: "请输入分组名称",
		pleaseSelectCountries: "请至少选择一个国家",
		createSuccess: "创建成功",
		createFailed: "创建失败",
		editGroup: "编辑分组",
		updateSuccess: "更新成功",
		updateFailed: "更新失败",
		deleteGroup: "删除分组",
		deleteGroupConfirm: "确定要删除分组 {name} 吗？",
		countriesSelected: "个国家已选择",
		emailManagement: "邮件管理",
		emailTypeManagement: "邮件类型管理",
		emailTemplateManagement: "邮件模版管理",
		smtpServerManagement: "邮件服务器",
		smtpServerManagementDesc: "配置用于发送邮件的 SMTP 服务器",
		emailTaskManagement: "邮件任务管理",
		emailTaskManagementDesc: "管理系统中的邮件任务",
		addSmtpServer: "新增邮件服务器",
		editSmtpServer: "编辑邮件服务器",
		viewSmtpServer: "查看邮件服务器",
		smtpHost: "SMTP 主机",
		smtpPort: "端口",
		smtpUsername: "用户名",
		smtpPassword: "密码",
		smtpFromName: "发件人名称",
		smtpFromEmail: "发件人邮箱",
		smtpSecure: "加密方式",
		sendEmail: "发送邮件",
		sendEmailConfirmIntro: "请确认邮件发送目标信息：",
		sendEmailConfirm: "确定给订单 {orderNo} 发送 {templateName} 邮件吗？",
		sendEmailSuccess: "邮件已发送",
		sendEmailFailed: "邮件发送失败",
		selectEmailTemplate: "选择邮件模版",
		emailTypeName: "类型名称",
		emailTypeNamePlaceholder: "请输入类型名称",
		totalAmount: "总金额",
		successCount: "成功次数",
		paymentRate: "支付率",

		orderVariable: "订单变量",
		orderVariablePlaceholder: "请输入订单变量描述",
		logisticsVariable: "物流变量",
		logisticsVariablePlaceholder: "请输入物流变量描述",
		clientVariable: "客户变量",
		clientVariablePlaceholder: "请输入客户变量描述",
		accountGrouping: "账号分组",
		accountGroupingDesc: "管理 Stripe 账号分组",
		addGroup: "添加分组",
		groupName: "分组名称",
		belongTo: "隶属",
		enterRemark: "请输入备注",
		selectStripeAccounts: "选择 Stripe 账号",
		nameRequired: "名称必填",
		yes: "是",
		no: "否",
		fraud_type_card_testing: "卡片测试",
		dispute_status_won: "胜诉",
		dispute_status_lost: "败诉",
		dispute_status_needs_response: "待响应",
		dispute_status_warning_closed: "警告关闭",
		dispute_status_under_review: "审核中",
		dispute_reason_fraudulent: "欺诈",
		dispute_reason_unrecognized: "未识别",
		dispute_reason_product_not_received: "未收到商品",
		dispute_reason_general: "常规",
		dispute_reason_credit_not_processed: "退款未处理",
		dispute_reason_duplicate: "重复扣款",
		dispute_reason_subscription_canceled: "订阅取消",
		dispute_reason_product_unacceptable: "商品不符",
		operationFailed: "操作失败",
		commentPlaceholder: "例如：内部参考或备注",
		descriptionPlaceholder: "更多详情...",
		// Filters
		startTime: "开始时间",
		endTime: "结束时间",
		paymentStatus: "支付状态",
		paymentChannel: "支付通道",
		reset: "重置",
		moreFilters: "更多筛选",
		logisticsStatus: "物流状态",
		orderStatus: "订单状态",
		orderNo: "订单号",
		pleaseSelect: "请选择",
		url: "网址",
		phone: "手机号",
		comment: "备注",
		selectUser: "请选择用户",
		enterOrderNo: "请输入订单号",
		enterPhone: "请输入手机号",
		enterEmail: "请输入邮箱",
		orderFirstName: "订单用户的姓",
		orderLastName: "订单用户的名",
		enterOrderFirstName: "请输入订单用户的姓",
		enterOrderLastName: "请输入订单用户的名",
		enterPaymentChannel: "请输入支付通道",
		recentOrders: "最近订单",
		blacklist: "黑名单",
		addBlacklist: "新增黑名单",
		basicInfo: "基本信息",
		add: "新增",
		enterName: "请输入姓名",
		editBlacklist: "编辑黑名单",
		user: "用户",
		contactInfo: "联系信息",
		basicInfoHint: "用户身份和角色设置",
		goTo: '前往',
		contactInfoHint: "联系渠道设置",
		pleaseEnterCaptcha: "请输入验证码",
		receipt: "收据",
		stTypeNormal: "正常",
		stTypePhishing: "钓鱼",
		st_level: "账号等级",
		st_type: "账号类型",
		st_risk_title: "风控与限额",
		st_risk_subtitle: "设置交易限额与地理限制",
		st_modal_desc_view: "查看该账号的详细信息。",
		st_modal_desc_edit: "填写下方详情以管理 Stripe 账号。",
		st_info_title: "账号信息",
		st_info_subtitle: "账号的基本详情与配置",
		st_api_title: "API 凭证",
		st_api_subtitle: "用于 Stripe 集成的安全密钥",
		st_warnings: "账号预警",
		st_disputes: "账户争议",
		st_fraud_type: "欺诈类型",
		st_actionable: "可操作",
		st_charge: "交易",
		st_reason: "原因",
		st_evidence_due_by: "举证截止",
		st_warning_list: "预警列表",
		st_dispute_list: "争议列表",
		st_today_order_amount_sum: "今日订单总金额",
		orderBelong: "订单归属",
		accountOwnership: "账号归属",
		isRequired: "不能为空",
		emailTaskHistory: '邮件任务历史',
		emailTemplate: '邮件模版',
		stripeCustomEmbeddedForms: "Stripe 自定义内嵌表单",
		stripeCheckout: "Stripe 收银台",
		paymentType: "支付类型",
		selectPaymentType: "选择支付类型",
		owner: "所有者",
		warning: "警告",
		dispute: "争议",
		collapse: "收起",
		selectStatus: "选择状态",
		taskStatus_failed: "失败",
		taskStatus_pending: "处理中",
		confirmUpdateOrderToSuccess: "确定要将订单状态更新为成功吗？",
		logisticsInfo: "物流信息",
		emailTemplateManagementDesc: "管理系统中的邮件模版",
		addEmailTemplate: "新增邮件模版",
		accessDenied: "访问被拒绝",
		logisticsShipment: "物流发货",
		logisticsMode: "物流模式",
		logisticsModeExample: "e.g. DHL, FedEx",
		trackingNumber: "物流跟踪号",
		confirm: "确认",
		saving: "保存中...",
		editEmailTask: "编辑邮件任务",
		addEmailTask: "新增邮件任务",
		addEmailType: "新增邮件类型",
		emailTypeManagementDesc: "管理系统中的邮件类型",
		taskStatus_sent: "已发送",
		taskStatus_cancelled: "已取消",
		uploadFailed: "上传失败",
		selectRole: "选择角色",
		selectParent: "选择上级",
		assignPaymentGroup: "分配支付分组",
		assignGroupHint: "为该用户选择支付分组",
		paymentGroup: "支付分组",
		selectPaymentGroup: "选择支付分组",
		noGroupsFound: "未找到支付分组",
		roleRequired: "请选择角色",
		parentRequired: "请选择上级",
	},
	en: {
		appTitle: "Payment System",
		dashboard: "Dashboard",
		login: "Login",
		logout: "Logout",
		guest: "Guest",
		username: "Username",
		password: "Password",
		rememberMe: "Remember me",
		rememberDevice: "Remember this device",
		submit: "Submit",
		orders: "Orders",
		users: "Users",
		filters: "Filters",
		startTime: "Start Time",
		endTime: "End Time",
		orderCurrency: "Order Currency",
		orderUser: "Order User",
		successOrder: "Successful Order",
		failedOrder: "Failed Order",
		status: "Status",
		all: "All",
		pending: "Pending",
		paid: "Paid",
		failed: "Failed",
		amount: "Amount",
		createdAt: "Created At",
		merchant: "Merchant",
		advertiser: "Advertiser",
		customerService: "Customer Service",
		orderId: "Order ID",
		role_super_admin: "Super Admin",
		role_admin: "Admin",
		role_merchant: "Merchant",
		role_cs: "CS",
		role_adv: "Advertiser",
		role_customer: "Customer",
		role: "Role",
		language: "Language",
		welcomeTitle: "Welcome to Payment System",
		welcomeSub: "Welcome to Payment System",
		createAccount: "Create Account",
		forgotPassword: "Forgot Password?",
		signIn: "Sign In",
		orSignIn: "Or sign in with",
		socialButton: "Button",
		facebook: "Facebook",
		twitter: "Twitter",
		todayIncome: "Today's Income",
		monthlySales: "Monthly Sales",
		salesComparison: "Sales Comparison",
		totalSalesShare: "Total Sales Share",
		productsPerformance: "Products Performance",
		assigned: "Assigned",
		name: "Name",
		priority: "Priority",
		budget: "Budget",
		low: "Low",
		medium: "Medium",
		high: "High",
		ordersCount: "Orders",
		paidCount: "Paid",
		refundsCount: "Refunds",
		download: "Download",
		apps: "Apps",
		chat: "Chat",
		calendar: "Calendar",
		email: "Email",
		search: "Search",
		notifications: "Notifications",
		messages: "Messages",
		theme: "Theme",
		light: "Light",
		dark: "Dark",
		earnings: "Earnings",
		customers: "Customers",
		products: "Products",
		sales: "Sales",
		recentTransactions: "Recent Transactions",
		downloadReport: "Download Report",
		expense: "Expense",
		yearlySales: "Yearly Sales",
		active: "Active",
		inactive: "Inactive",
		good: "Good",
		excellent: "Excellent",
		average: "Average",
		bad: "Bad",
		addNew: "Add New",
		privacyPolicy: "Privacy Policy",
		termsOfService: "Terms of Service",
		contactUs: "Contact Us",
		userDetailsTitle: "User Details",
		userDetailsHint: "Edit and save user details here",
		icpRecord: "ICP Record",
		totalSales: "Total Sales",
		todayOrders: "Today's Orders",
		todaySales: "Today's Sales",
		yesterdayOrders: "Yesterday's Orders",
		yesterdaySales: "Yesterday's Sales",
		orderRatio: "Order Ratio (Today)",
		cookieSettings: "Cookie Settings",
		userManagement: "User Management",
		userList: "User List",
		addUser: "Add User",
		editUser: "Edit User",
		roleManagement: "Role Management",
		addRole: "Add Role",
		editRole: "Edit Role",
		roleName: "Role Name",
		createTime: "Create Time",
		status_active: "Active",
		status_inactive: "Inactive",
		actions: "Actions",
		edit: "Edit",
		filter: "Filter",
		filters: "Filters",
		noData: "No Data",
		clickToUpload: "Click to upload image",
		notShipped: "Not Shipped",
		shipped: "Shipped",
		delete: "Delete",
		deleteUserSuccess: "Delete Success",
		deleteUserFailed: "Delete Failed",
		createUserSuccess: "Create Success",
		createUserFailed: "Create Failed",
		editUserSuccess: "Edit Success",
		editUserFailed: "Edit Failed",
		mobile: "Mobile",
		tgid: "TG ID",
		qunid: "Group ID",
		total: "Total",
		prev: "Prev",
		next: "Next",
		save: "Save",
		cancel: "Cancel",
		captcha: "Captcha",
		getCaptcha: "Get Captcha",
		pleaseEnterUsername: "Please enter username",
		captchaFetchFailed: "Captcha fetch failed",
		captchaFetched: "Captcha fetched",
		loginFailed: "Login failed",
		logoutSuccess: "Logged out",
		logoutFailed: "Logout failed",
		illustrationPlaceholder: "Illustration Placeholder",
		missingCaptcha: "Missing captcha",
		// New additions
		loading: "Loading...",
		orderDetailsAndChannel: "Details & Channel",
		customer: "Customer",
		timeline: "Timeline",
		site: "Site",
		channel_abbr: "Channel",
		untitledOrder: "Untitled Order",
		untitledChannel: "Untitled Channel",
		ref: "Ref",
		rate: "Rate",
		err: "Err",
		upd: "Upd",
		crt: "Crt",
		succeed: "Succeed",
		noPay: "Unpaid",
		itemsPerPage: "Items / page",
		paginationInfo: "{start} – {end} of {total}",
		prevPage: "Previous Page",
		nextPage: "Next Page",
		confirmDelete: "Are you sure to delete?",
		deleteSuccess: "Deleted successfully",
		deleteFailed: "Delete failed",
		saveSuccess: "Saved successfully",
		saveFailed: "Save failed",
		usernameRequired: "Username is required",
		passwordRequired: "Password is required",
		searchPlaceholder: "Search site/email/remark",
		sold: "Sold",
		copied: "Copied",
		copyFailed: "Copy failed",
		clickToCopy: "Click to copy",
		riskScore: "Risk Score",
		failureCode: "Failure Code",
		failureMsg: "Failure Msg",
		operations: "Operations",
		details: "Details",
		radar: "Radar",
		update: "Update",
		riskAnalysis: "Risk Analysis",
		normalRisk: "Normal Risk",
		riskScoreExplanation: "The risk factors for this payment have been compared with other payments in the network.",
		customerDetails: "Customer Details",
		checkoutDetails: "Checkout Details",
		customerEmail: "Customer Email",
		billingAddress: "Billing Address",
		ipAddress: "IP Address",
		ipAddressDetail: "IP Details",
		longitudeAndLatitude: "Longitude & Latitude",
		internetServiceProvider: "ISP",
		vpn: "VPN",
		proxy: "Proxy",
		userAgent: "User Agent",
		paymentDetails: "Payment Details",
		cardBrand: "Card Brand",
		fundingType: "Funding Type",
		cardCountry: "Card Country",
		cvcCheck: "CVC Check",
		threeDSecure: "3D Secure",
		wallet: "Wallet",
		hostname: "Hostname",
		region: "Region",
		postalCode: "Postal Code",
		location: "Location",
		organization: "Organization",
		timezone: "Timezone",
		amountAuthorized: "Amount Authorized",
		authCode: "Auth Code",
		addressCheck: "Address Check",
		zipCheck: "Zip Check",
		fingerprint: "Fingerprint",
		network: "Network",
		networkTransactionId: "Network Transaction ID",
		paymentType: "Payment Type",
		orderDetails: "Order Details",
		contactDetails: "Contact Details",
		transactionDetails: "Transaction Details",
		technicalDetails: "Technical Details",
		country: "Country",
		city: "City",
		zipcode: "Zipcode",
		idLabel: "ID",
		codeLabel: "Code",
		technicalSub: "IP, User Agent & Device",
		ipv6: "IPv6",
		chargesList: "Charges List",
		chargesListSub: "All payment attempts and refunds associated with this order",
		paymentMethod: "Payment Method",
		date: "Date",
		refunded: "Refunded",
		stripeAccounts: "Stripe Accounts",
		stripeManagement: "Stripe Management",
		accountList: "Account List",
		stripeWhitelistGroups: "Whitelist Groups",
		stripeLogs: "Stripe Logs",
		st_id: "ID",
		st_status: "Status",
		st_status_inactive: "Inactive",
		st_status_active: "Active",
		st_status_completed: "Completed",
		st_status_suspended: "Suspended",
		st_group: "Group",
		st_comment: "Comment",
		st_site: "Site",
		st_keys: "Keys",
		st_limits: "Limits",
		st_stats: "Stats",
		st_dates: "Dates",
		st_max_money: "Max Money",
		st_max_order: "Max Orders",
		st_money_sum: "Total Money",
		st_order_count: "Total Orders",
		st_add: "Add Account",
		st_edit: "Edit Account",
		st_pk: "Public Key (PK)",
		st_sk: "Secret Key (SK)",
		st_endpoint_secret: "Webhook Secret",
		st_desc: "Description",
		st_max_purchase: "Max Purchase",
		st_whitelist: "Country Whitelist",
		st_whitelist_placeholder: "Enter country codes separated by comma (e.g. US, JP)",
		st_whitelist_group: "Country Group",
		st_whitelist_group_placeholder: "Select country group",
		st_c_site_url: "C-Site URL",
		view: "View",
		edit: "Edit",
		logDetails: "Log Details",
		account: "Account",
		type: "Type",
		content: "Content",
		close: "Close",
		whitelistGroupsTitle: "Whitelist Groups",
		whitelistGroupsSub: "Configure reusable country whitelist groups",
		createGroup: "Create Group",
		noGroupsConfigured: "No groups configured",
		whitelistGroupFeatureDesc: "This feature allows you to create reusable country whitelist groups.",
		loadFailed: "Load Failed",
		searchGroupPlaceholder: "Search group name",
		featureUnderDevelopment: "Feature under development...",
		enterGroupName: "Enter group name",
		selectCountries: "Select Countries",
		searchCountries: "Search countries...",
		pleaseEnterName: "Please enter group name",
		pleaseSelectCountries: "Please select at least one country",
		createSuccess: "Create Success",
		createFailed: "Create Failed",
		editGroup: "Edit Group",
		updateSuccess: "Update Success",
		updateFailed: "Update Failed",
		deleteGroup: "Delete Group",
		deleteGroupConfirm: "Are you sure to delete group {name}?",
		countriesSelected: "countries selected",
		emailManagement: "Email Management",
		emailTypeManagement: "Email Types",
		emailTemplateManagement: "Email Templates",
		smtpServerManagement: "SMTP Servers",
		smtpServerManagementDesc: "Configure SMTP servers for sending emails",
		emailTaskManagement: "Email Tasks",
		emailTaskManagementDesc: "Manage system email tasks",
		addSmtpServer: "Add SMTP Server",
		editSmtpServer: "Edit SMTP Server",
		viewSmtpServer: "View SMTP Server",
		smtpHost: "SMTP Host",
		smtpPort: "Port",
		smtpUsername: "Username",
		smtpPassword: "Password",
		smtpFromName: "From Name",
		smtpFromEmail: "From Email",
		smtpSecure: "Encryption",
		sendEmail: "Send Email",
		sendEmailConfirmIntro: "Please confirm email target info:",
		sendEmailConfirm: "Are you sure to send {templateName} to order {orderNo}?",
		sendEmailSuccess: "Email sent successfully",
		sendEmailFailed: "Email sending failed",
		selectEmailTemplate: "Select Email Template",
		emailTypeName: "Type Name",
		emailTypeNamePlaceholder: "Enter type name",
		totalAmount: "Total Amount",
		successCount: "Success Count",
		paymentRate: "Payment Rate",

		orderVariable: "Order Variable",
		orderVariablePlaceholder: "Enter order variable description",
		logisticsVariable: "Logistics Variable",
		logisticsVariablePlaceholder: "Enter logistics variable description",
		clientVariable: "Client Variable",
		clientVariablePlaceholder: "Enter client variable description",
		// Filters
		paymentStatus: "Payment Status",
		paymentChannel: "Payment Channel",
		reset: "Reset",
		moreFilters: "More Filters",
		logisticsStatus: "Logistics Status",
		orderStatus: "Order Status",
		orderNo: "Order No",
		pleaseSelect: "Please Select",
		url: "URL",
		phone: "Phone",
		comment: "Comment",
		selectUser: "Select User",
		enterOrderNo: "Enter Order No",
		enterPhone: "Enter Phone",
		enterEmail: "Enter Email",
		orderFirstName: "Order First Name",
		orderLastName: "Order Last Name",
		enterOrderFirstName: "Enter Order First Name",
		enterOrderLastName: "Enter Order Last Name",
		enterPaymentChannel: "Enter Payment Channel",
		recentOrders: "Recent Orders",
		blacklist: "Blacklist",
		addBlacklist: "Add Blacklist",
		basicInfo: "Basic Info",
		add: "Add",
		enterName: "Enter Name",
		editBlacklist: "Edit Blacklist",
		user: "User",
		contactInfo: "Contact Info",
		basicInfoHint: "User identity and role settings",
		goTo: 'Go to',
		contactInfoHint: "Contact channel settings",
		pleaseEnterCaptcha: "Please enter captcha",
		receipt: "Receipt",
		stTypeNormal: "Normal",
		stTypePhishing: "Phishing",
		st_level: "Account Level",
		st_type: "Account Type",
		st_risk_title: "Risk Controls & Limits",
		st_risk_subtitle: "Set transaction limits and geographical restrictions",
		st_modal_desc_view: "View detailed information for this account.",
		st_modal_desc_edit: "Fill in the details below to manage the Stripe account.",
		st_info_title: "Account Information",
		st_info_subtitle: "Basic details and configuration for this account",
		st_api_title: "API Credentials",
		st_api_subtitle: "Secure keys for Stripe integration",
		st_warnings: "Warnings",
		st_disputes: "Disputes",
		st_fraud_type: "Fraud Type",
		st_actionable: "Actionable",
		st_charge: "Charge",
		st_reason: "Reason",
		st_evidence_due_by: "Evidence Due By",
		st_warning_list: "Warning List",
		st_dispute_list: "Dispute List",
		st_today_order_amount_sum: "Today Total Order Amount",
		orderBelong: "Order ownership",
		accountOwnership: "Account ownership",
		isRequired: "is required",
		emailTaskHistory: 'Email Task History',
		emailTemplate: 'Email Template',
		stripeCustomEmbeddedForms: "Stripe Custom embedded forms",
		stripeCheckout: "Stripe Checkout",
		paymentType: "Payment Type",
		selectPaymentType: "Select payment type",
		owner: "Owner",
		remark: "Remark",
		warning: "Warning",
		dispute: "Dispute",
		collapse: "Collapse",
		selectStatus: "Select status",
		taskStatus_failed: "Failed",
		taskStatus_pending: "Pending",
		confirmUpdateOrderToSuccess: "Are you sure to update order status to success?",
		logisticsInfo: "Logistics Information",
		emailTemplateManagementDesc: "Manage email templates for sending emails",
		addEmailTemplate: "Add Email Template",
		accessDenied: "Access Denied",
		confirm: "Confirm",
		saving: "Saving...",
		editEmailTask: "Edit Email Task",
		addEmailTask: "Add Email Task",
		addEmailType: "Add Email Type",
		emailTypeManagementDesc: "Manage email types for email templates",
		taskStatus_sent: "Sent",
		taskStatus_cancelled: "Cancelled",
		uploadFailed: "Upload Failed",
		selectRole: "Select Role",
		selectParent: "Select Parent",
		assignPaymentGroup: "Assign Payment Group",
		assignGroupHint: "Select a payment group for this user",
		paymentGroup: "Payment Group",
		selectPaymentGroup: "Select Payment Group",
		noGroupsFound: "No payment groups found",
		roleRequired: "Role is required",
		parentRequired: "Belong To is required",
	},
};

export const I18nContext = createContext({
	t: (key) => key,
	lang: "en",
	setLanguage: () => {},
});

export function I18nProvider({ children }) {
	const lang = useSelector((s) => s.ui.lang);
	const dispatch = useDispatch();
	const setLanguage = (l) => dispatch(setLang(l));
	const dict = messages[lang] || messages.en;

	useEffect(() => {
		db.get("lang").then((savedLang) => {
			if (savedLang && messages[savedLang]) {
				dispatch(setLang(savedLang));
			}
		});
	}, [dispatch]);

	const value = useMemo(
		() => ({
			t: (k) => dict[k] || k,
			lang,
			setLanguage,
		}),
		[dict, lang]
	);

	return <I18nContext.Provider value={value}>{children}</I18nContext.Provider>;
}

export const useI18n = () => useContext(I18nContext);
